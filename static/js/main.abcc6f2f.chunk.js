(this["webpackJsonpsticker-scraper"]=this["webpackJsonpsticker-scraper"]||[]).push([[0],{1271:function(e,t,n){"use strict";n.r(t);var r=n(17),s=n.n(r),a=n(29),i=(n(72),n(73),n(0)),c=n(12),o=n(6),u=n(14),h=n(21),d=n(4),l=n(26),b=n.n(l),j=n(39),f=n.n(j),p=n(3),O=["className","disablePadding"],v=function(e){var t=e.className,n=e.disablePadding,r=Object(d.a)(e,O);return Object(p.jsx)("div",Object(u.a)({className:b()(f.a.root,Object(h.a)({},f.a.padding,!n),t)},r))},x=n(5),m=document.documentElement,g=function(){var e=Object(o.n)();return Object(i.useEffect)((function(){for(var t=e.palette,n=0,r=Object.entries(t);n<r.length;n++){var s=Object(x.a)(r[n],2),a=s[0],i=s[1];m.style.setProperty("--palette-"+a,i)}}),[e]),null},k=n(54),w=n.n(k),y=n(55),C=n.n(y),I=["className"],T=["component","children"],A=function(e){var t=e.className,n=Object(d.a)(e,I);return Object(p.jsx)("div",Object(u.a)({className:b()(t,C.a.thumb)},n))},_=function(e,t){var n=e.component,r=void 0===n?"div":n,s=e.children,a=Object(d.a)(e,T),c=Object(i.useCallback)((function(e){e&&t&&"object"===typeof t?t.current=e.view:e&&"function"===typeof t?null===t||void 0===t||t(e.view):"function"===typeof t&&(null===t||void 0===t||t(null))}),[]),o=Object(i.useCallback)((function(e){return Object(p.jsx)(r,Object(u.a)({},e))}),[r]);return Object(p.jsx)(w.a,Object(u.a)(Object(u.a)({ref:c,renderView:o,renderThumbHorizontal:A,renderThumbVertical:A},a),{},{children:s}))},S=Object(i.forwardRef)(_),N=n(56),L=n.n(N),E=n(57),P=n.n(E),R=n(10),z=n(15),M=n(16),U=n(7),D=n.n(U),H=n(8),F=n(32),W=n(58),Z={useTestDc:false,readOnly:!1,instanceName:"tdlib",apiId:parseInt("6544363"),apiHash:"86ef20b7ba5e5464dc7079e760e1499c",jsLogVerbosityLevel:"info",logVerbosityLevel:1,useDatabase:!0,useFileDatabase:!0,useChatInfoDatabase:!0,useMessageDatabase:!0,useSecretChats:!1},B=function(){function e(){Object(z.a)(this,e),this.current=void 0}return Object(M.a)(e,[{key:"makeAsync",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.current){e.next=3;break}return e.next=3,this.current.api.destroy();case 3:return t=new F.Airgram(Z),this.current=t,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),V=n(13),q=n(30),Q=function(){function e(){Object(z.a)(this,e),this.handlers=[]}return Object(M.a)(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handlers.push(t),this}},{key:"build",value:function(){var e=this;return function(t,n){var r,s=null!==(r=e.handlers.filter((function(e){return Object(x.a)(e,1)[0]===t._})))&&void 0!==r?r:[];return s.length?q.Composer.compose(s.map((function(e){return Object(x.a)(e,2)[1]})))(t,n):n()}}}]),e}(),J=function(){function e(t){var n=this;Object(z.a)(this,e),this.rootStore=t,this.state=void 0,this.firstLaunch=!0,this.user=void 0,this.handlers=(new Q).add(V.UPDATE.updateAuthorizationState,(function(e){var t,r=e.update.authorizationState;if(n.firstLaunch&&r._===V.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber&&(null===(t=n.state)||void 0===t?void 0:t._)===V.AUTHORIZATION_STATE.authorizationStateWaitEncryptionKey)return n.firstLaunch=!1,void n.switchToQr();Object(H.g)((function(){n.state=r}))})).build(),Object(H.d)(this,{user:H.f.ref,handlers:!1})}return Object(M.a)(e,[{key:"switchToQr",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.state)||void 0===t?void 0:t._)!==V.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.rootStore.Airgram.api.requestQrCodeAuthentication();case 4:if("error"!==(n=e.sent).response._){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"switchToPhoneNumber",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.state)||void 0===t?void 0:t._)!==V.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.reset();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(R.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.firstLaunch=!1,e.next=3,this.rootStore.resetAirgram();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logOut",value:function(){var e=Object(R.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rootStore.Airgram.api.logOut();case 2:return this.firstLaunch=!0,e.next=5,this.rootStore.resetAirgram();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendPhoneNumber",value:function(e){return this.rootStore.Airgram.api.setAuthenticationPhoneNumber({phoneNumber:e})}},{key:"sendCode",value:function(e){return this.rootStore.Airgram.api.checkAuthenticationCode({code:e})}},{key:"sendPassword",value:function(e){return this.rootStore.Airgram.api.checkAuthenticationPassword({password:e})}},{key:"getMe",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.user){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.rootStore.Airgram.api.getMe();case 4:if("error"!==(t=e.sent).response._){e.next=7;break}throw t.response;case 7:this.user=t.response;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),K=function(){function e(t){var n=this;Object(z.a)(this,e),this.rootStore=t,this.chats=new Map,this.handlers=(new Q).add(V.UPDATE.updateNewChat,(function(e,t){return n.updateChat(e.update.chat.id,(function(t){t.info=e.update.chat})),t()})).add(V.UPDATE.updateChatPosition,(function(e,t){return n.updateChat(e.update.chatId,(function(t){t.position=e.update.position})),t()})).add(V.UPDATE.updateChatLastMessage,(function(e,t){n.updateChat(e.update.chatId,(function(t){t.lastMessage=e.update.lastMessage}));var r=e.update.positions.find((function(e){return"chatListMain"===e.list._}));return r&&n.updateChat(e.update.chatId,(function(e){e.position=r})),t()})).build(),Object(H.d)(this,{chats:H.f.shallow,handlers:!1})}return Object(M.a)(e,[{key:"updateChat",value:function(e,t){var n,r=this.chats.get(e);r||(r={}),r=null!==(n=t(r))&&void 0!==n?n:r,this.chats.set(e,r)}},{key:"load",value:function(){return this.rootStore.Airgram.api.loadChats({chatList:{_:"chatListMain"},limit:10})}},{key:"chatsList",get:function(){return Array.from(this.chats.values()).sort((function(e,t){var n,r,s,a;return BigInt(null!==(n=null===(r=e.position)||void 0===r?void 0:r.order)&&void 0!==n?n:0)<BigInt(null!==(s=null===(a=t.position)||void 0===a?void 0:a.order)&&void 0!==s?s:0)?0:-1})).sort((function(e,t){var n,r,s=null===(n=e.position)||void 0===n?void 0:n.isPinned;return s===(null===(r=t.position)||void 0===r?void 0:r.isPinned)?0:s?-1:1}))}}]),e}(),Y=Object(M.a)((function e(t){var n=this;Object(z.a)(this,e),this.rootStore=t,this.state=V.CONNECTION_STATE.connectionStateWaitingForNetwork,this.middleware=function(){return function(){var e=Object(R.a)(D.a.mark((function e(t,r){var s,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._===V.UPDATE.updateConnectionState&&"update"in t&&(s=t.update,a=s.state._,n.state=a),e.abrupt("return",r());case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},Object(H.d)(this,{middleware:!1})})),G="theme",X="light";window.matchMedia("(prefers-color-scheme: dark)").matches&&(X="dark");var $=localStorage.getItem(G);$&&(X=$);var ee=function(){function e(){Object(z.a)(this,e),this.currentTheme=X,Object(H.d)(this)}return Object(M.a)(e,[{key:"toggleTheme",value:function(){var e="dark"===this.currentTheme?"light":"dark";this.currentTheme=e,localStorage.setItem(G,e)}}]),e}(),te=new B,ne=function(){function e(){var t=this;Object(z.a)(this,e),this.events=new W.EventEmitter,this.emit=function(n,r){var s,a=null!==(s=t.events.listeners(e.eventName))&&void 0!==s?s:[];return F.Composer.compose(a)(n,r)},this.Theme=new ee,this.Airgram=void 0,this.Authorization=new J(this),this.Connection=new Y(this),this.Chats=new K(this),this.resetAirgram(),Object(H.d)(this,{events:!1,Airgram:!1})}return Object(M.a)(e,[{key:"resetAirgram",value:function(){var e=Object(R.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.makeAsync();case 2:this.Airgram=e.sent,this.Airgram.use(this.Authorization.handlers,this.Connection,this.Chats.handlers,this.emit);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();ne.eventName="action";var re=new ne,se=Object(i.createContext)(re),ae=function(e){var t=e.children;return Object(p.jsx)(se.Provider,{value:re,children:t})},ie=n(59);function ce(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(R.a)(D.a.mark((function e(t){var n,r,s,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.arrayBuffer();case 2:return n=e.sent,r=new Uint8Array(n),s=ie.a.inflate(r),e.next=7,new Blob([s]).text();case 7:return a=e.sent,e.abrupt("return",JSON.parse(a));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return new Response(new Blob([e],{type:"application/json"})).text()}function he(e){return new Response(e).text()}function de(e){var t=new FileReader;return t.readAsDataURL(e),new Promise((function(e,n){t.onloadend=function(){e(t.result)},t.onerror=function(e){n(e)}}))}var le=new Map,be=function(){function e(t,n,r,s){var a=this;Object(z.a)(this,e),this.rootStore=t,this.isLoading=!1,this.format=void 0,this.file=void 0,this.content=void 0,this.params=void 0,this.handlers=(new Q).add(V.UPDATE.updateFile,(function(e,t){var n;return e.update.file.id===(null===(n=a.file)||void 0===n?void 0:n.id)&&a.load(),t()})).build(),Object(H.d)(this,{content:H.f.ref,handlers:!1}),this.file=n,this.format=r,this.params=s,this.load(),t.events.addListener(ne.eventName,this.handlers)}return Object(M.a)(e,[{key:"setContent",value:function(e){this.content=e}},{key:"dispose",value:function(){this.rootStore.events.removeListener(ne.eventName,this.handlers)}},{key:"setFile",value:function(e,t,n){return this.file=e,this.format!==t&&(this.content=void 0,this.format=t),this.params=n,this.load()}},{key:"load",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t,n,r,s,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.file&&!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(!this.content){e.next=4;break}return e.abrupt("return",this.content);case 4:if(e.prev=4,this.isLoading=!0,t=this.file.id,!(n=le.get(t))){e.next=11;break}return this.setContent(n),e.abrupt("return",n);case 11:return e.next=13,this.rootStore.Airgram.api.downloadFile(Object(u.a)({fileId:t,priority:1},this.params));case 13:if("error"!==e.sent.response._){e.next=16;break}return e.abrupt("return");case 16:return e.next=18,this.rootStore.Airgram.api.readFilePart({fileId:t});case 18:if("error"!==(r=e.sent).response._){e.next=21;break}return e.abrupt("return");case 21:if(s=r.response.data,a=null,"blob"===this.format&&(a=s),"base64"!==this.format){e.next=28;break}return e.next=27,de(s);case 27:a=e.sent;case 28:if("text"!==this.format){e.next=32;break}return e.next=31,he(s);case 31:a=e.sent;case 32:if("json"!==this.format){e.next=36;break}return e.next=35,ue(s);case 35:a=e.sent;case 36:if("lotty"!==this.format){e.next=40;break}return e.next=39,ce(s);case 39:a=e.sent;case 40:return le.set(t,a),this.setContent(a),e.abrupt("return",a);case 43:return e.prev=43,this.isLoading=!1,e.finish(43);case 46:case"end":return e.stop()}}),e,this,[[4,,43,46]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function je(e,t,n){var r=Object(c.b)((function(){return new be(re)}));return Object(i.useEffect)((function(){return function(){r.dispose()}}),[]),Object(i.useEffect)((function(){r.setFile(e,t,n)}),[e,t,n,r]),r.content}var fe=n(40),pe=n.n(fe),Oe=Object(c.a)((function(e){var t=e.sticker,n=je(t.sticker,t.isAnimated?"lotty":"base64");return t.isAnimated?Object(p.jsx)(P.a,{intervalCheck:!0,scrollCheck:!0,children:function(e){var t=e.isVisible;return Object(p.jsx)(L.a,{loop:t,renderer:"svg",className:pe.a.root,animationData:n})}}):Object(p.jsx)("img",{className:pe.a.root,alt:"",src:n})})),ve=function(e){return Object(p.jsx)(o.d.Container,Object(u.a)({wrap:"nowrap",height:"64px",alignItems:"center"},e))},xe=n(60),me=n.n(xe),ge=["className"],ke=function(e){var t=e.className,n=Object(d.a)(e,ge);return Object(p.jsx)(o.l,Object(u.a)({className:b()(me.a.card,t)},n))},we=n(27),ye=function(){var e=Object(i.useContext)(se).Authorization,t=Object(i.useState)(!1),n=Object(x.a)(t,2),r=n[0],s=n[1],a=Object(we.b)(),c=a.formState.errors,h=a.register,d=a.handleSubmit,l=a.setError,b=Object(i.useCallback)(function(){var t=Object(R.a)(D.a.mark((function t(n){var a,i;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.phoneNumber,!r){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,s(!0),t.next=7,e.sendPhoneNumber(a);case 7:if("error"!==(i=t.sent).response._){t.next=10;break}throw i.response._;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),l("phoneNumber",{message:t.t0});case 15:return t.prev=15,s(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})));return function(e){return t.apply(this,arguments)}}(),[e,r,l]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:d(b),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Log in to Telegram"}),Object(p.jsx)(o.k,{margin:0,children:"by phone number"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.e,Object(u.a)({autoFocus:!0,disabled:r,type:c.phoneNumber?"error":void 0},h("phoneNumber",{required:!0}))),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{disabled:r,htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{ghost:!0,type:"success",onClick:function(){return e.switchToQr()},children:"Log in by qr code"})]})})})},Ce=Object(c.a)((function(){var e=Object(i.useContext)(se).Authorization,t=Object(we.b)(),n=t.handleSubmit,r=t.setError,s=t.control,a=e.state,c=Object(we.a)({defaultValue:"",name:"code",rules:{required:!0},control:s}),u=c.field,h=u.value,d=u.onChange,l=c.fieldState.error,b=Object(i.useCallback)(function(){var t=Object(R.a)(D.a.mark((function t(n){var s,a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.code,t.prev=1,t.next=4,e.sendCode(s);case 4:if("error"!==(a=t.sent).response._){t.next=7;break}throw a.response._;case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),r("code",{message:t.t0});case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),[e,r]),j=Object(i.useCallback)((function(e){var t=e.target.value;d(t),5===t.length&&n(b)(e)}),[n,d,b]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:n(b),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:a.codeInfo.phoneNumber}),Object(p.jsx)(o.e,{autoFocus:!0,label:"Code",type:l?"error":void 0,value:h,onChange:j}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{type:"success",ghost:!0,onClick:function(){return e.reset()},children:"Reset"})]})})})})),Ie=Object(c.a)((function(){var e=Object(i.useContext)(se).Authorization,t=Object(i.useState)(!1),n=Object(x.a)(t,2),r=n[0],s=n[1],a=Object(we.b)(),c=a.formState.errors,h=a.register,d=a.handleSubmit,l=a.setError,b=e.state,j=Object(i.useCallback)(function(){var t=Object(R.a)(D.a.mark((function t(n){var a,i;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.password,!r){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,s(!0),t.next=7,e.sendPassword(a);case 7:if("error"!==(i=t.sent).response._){t.next=10;break}throw i.response._;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),l("password",{message:t.t0});case 15:return t.prev=15,s(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})));return function(e){return t.apply(this,arguments)}}(),[e,r,l]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:d(j),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Enter Your Password"}),Object(p.jsx)(o.e.Password,Object(u.a)({autoFocus:!0,disabled:r,placeholder:b.passwordHint,type:c.password?"error":void 0},h("password",{required:!0}))),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{disabled:r,htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{type:"success",ghost:!0,onClick:function(){return e.reset()},children:"Reset"})]})})})})),Te=n(61),Ae=n.n(Te),_e=n(62),Se=n.n(_e),Ne=Object(c.a)((function(){var e=Object(i.useContext)(se).Authorization,t=e.state;return Object(p.jsx)(v,{children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Log in to Telegram"}),Object(p.jsx)(o.k,{margin:0,children:"by qr code"}),Object(p.jsx)(o.i,{}),Object(p.jsx)("div",{className:Se.a.codeArea,children:Object(p.jsx)(v,{disablePadding:!0,children:t.link?Object(p.jsx)(Ae.a,{includeMargin:!0,renderAs:"svg",value:t.link,size:240}):Object(p.jsx)(o.j,{})})}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{ghost:!0,type:"success",onClick:function(){return e.switchToPhoneNumber()},children:"Log in by phone number"})]})})})),Le=Object(c.a)((function(){var e,t,n,r,s=Object(i.useContext)(se).Authorization;return(null===(e=s.state)||void 0===e?void 0:e._)===V.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber?Object(p.jsx)(ye,{}):(null===(t=s.state)||void 0===t?void 0:t._)===V.AUTHORIZATION_STATE.authorizationStateWaitCode?Object(p.jsx)(Ce,{}):(null===(n=s.state)||void 0===n?void 0:n._)===V.AUTHORIZATION_STATE.authorizationStateWaitPassword?Object(p.jsx)(Ie,{}):(null===(r=s.state)||void 0===r?void 0:r._)===V.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation?Object(p.jsx)(Ne,{}):null})),Ee=[V.AUTHORIZATION_STATE.authorizationStateWaitTdlibParameters,V.AUTHORIZATION_STATE.authorizationStateWaitEncryptionKey],Pe=[V.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber,V.AUTHORIZATION_STATE.authorizationStateWaitCode,V.AUTHORIZATION_STATE.authorizationStateWaitPassword,V.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation],Re=Object(c.a)((function(e){var t=e.children,n=Object(i.useContext)(se).Authorization;return!n.state||Ee.includes(n.state._)?Object(p.jsx)(v,{children:Object(p.jsx)(o.j,{scale:5})}):Pe.includes(n.state._)?Object(p.jsx)(Le,{}):Object(p.jsx)(p.Fragment,{children:t})})),ze=n(11),Me=n(23),Ue=Object(c.a)((function(){var e,t,n=Object(i.useContext)(se).Authorization,r=je(null===(e=n.user)||void 0===e||null===(t=e.profilePhoto)||void 0===t?void 0:t.small,"base64",{priority:32});return Object(i.useEffect)((function(){n.getMe()}),[]),n.user?Object(p.jsxs)(o.d.Container,{wrap:"nowrap",alignItems:"center",xs:!0,children:[Object(p.jsx)(ke,{src:r,name:"".concat(n.user.firstName," ").concat(n.user.lastName),children:n.user.username}),Object(p.jsx)("div",{style:{flex:1}}),Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:Object(p.jsx)(Me.c,{}),onClick:function(){return n.logOut()}})]}):Object(p.jsx)(o.j,{})})),De=n(33),He=n(34),Fe=n.n(He),We=["chat","className"],Ze=function(e){var t,n,r,s,i=e.chat,c=e.className,h=Object(d.a)(e,We),l=je(null===(t=i.info)||void 0===t||null===(n=t.photo)||void 0===n?void 0:n.small,"base64");return Object(p.jsx)(a.b,Object(u.a)(Object(u.a)({to:"/conversation/".concat(null===(r=i.info)||void 0===r?void 0:r.id),className:b()(Fe.a.chat,c),activeClassName:Fe.a.active_chat},h),{},{children:Object(p.jsx)(o.d.Container,{className:Fe.a.container,alignItems:"center",height:"100%",width:"100%",children:Object(p.jsx)(ke,{src:l,name:null===(s=i.info)||void 0===s?void 0:s.title})})}))},Be=Object(i.memo)(Ze),Ve=n(65),qe=n.n(Ve),Qe=0,Je=Object(c.a)((function(){var e=Object(i.useContext)(se).Chats,t=e.chatsList,n=Object(i.useRef)(),r=Object(De.a)({size:t.length,parentRef:n,estimateSize:Object(i.useCallback)((function(){return 64}),[])});Object(i.useEffect)((function(){r.scrollToOffset(Qe)}),[]);var s=Object(i.useCallback)((function(e){var t=e.target;Qe=t.scrollTop}),[]);return Object(p.jsx)(o.d.Container,{className:qe.a.root,direction:"column",justify:"flex-start",children:Object(p.jsx)(S,{ref:n,onScroll:s,children:Object(p.jsx)("div",{style:{height:"".concat(r.totalSize,"px"),width:"100%",position:"relative"},children:r.virtualItems.map((function(e){var n,r,s=e.index,a=e.size,i=e.start,c=t[s];return Object(p.jsx)(Be,{chat:c,style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(a,"px"),transform:"translateY(".concat(i,"px)")}},null!==(n=null===(r=c.info)||void 0===r?void 0:r.id)&&void 0!==n?n:s)}))})})})})),Ke=Object(c.a)((function(){return Object(p.jsxs)(o.d.Container,{direction:"column",justify:"flex-start",alignItems:"stretch",children:[Object(p.jsx)(ve,{children:Object(p.jsx)(Ue,{})}),Object(p.jsx)(Je,{})]})})),Ye=n(22),Ge=new Map,Xe=function(){function e(t,n){var r=this;if(Object(z.a)(this,e),this.rootStore=t,this.chatId=n,this.isLoading=!1,this.isRestored=!1,this.startMessage=0,this.canLoad=!0,this.chat=void 0,this.messages=[],this.messageIds=new Map,this.stickerIds=new Map,this.processed=0,this.total=0,this.batch=0,this.handlers=(new Q).add(V.UPDATE.updateNewChat,(function(e,t){return e.update.chat.id===r.chatId&&r.load(),t()})).add(V.UPDATE.updateNewMessage,(function(e,t){var n=e.update.message;return n.chatId!==r.chatId||r.messageIds.has(n.id)||(r.messageIds.set(n.id,!0),"messageSticker"!==n.content._||r.stickerIds.has(n.content.sticker.setId)||(r.addMessage(n),r.stickerIds.set(n.content.sticker.setId,!0)),r.save()),t()})).build(),Ge.has(n)){var s=Ge.get(n);Object.assign(this,s),this.isRestored=!0}Object(H.d)(this,{chat:H.f.ref,messages:H.f.shallow,messageIds:H.f.shallow,stickerIds:H.f.shallow,dispose:!1,handlers:!1}),t.events.addListener(ne.eventName,this.handlers)}return Object(M.a)(e,[{key:"setLoading",value:function(e){this.isLoading=e}},{key:"insertMessage",value:function(e){this.messages.unshift(e)}},{key:"addMessage",value:function(e){this.messages.push(e)}},{key:"setLoadingProgress",value:function(e,t,n){this.processed=e,this.total=t,this.batch=n}},{key:"dispose",value:function(){this.rootStore.events.removeListener(ne.eventName,this.handlers)}},{key:"init",value:function(){if(!this.isRestored)return this.load()}},{key:"load",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t,n,r,s,a,i,c,o,u,h=this;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canLoad&&!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(this.setLoadingProgress(0,0,0),this.setLoading(!0),e.prev=4,this.chat){e.next=14;break}return e.next=8,this.rootStore.Airgram.api.getChat({chatId:this.chatId});case 8:if("chat"!==(t=e.sent).response._){e.next=13;break}this.chat=t.response,e.next=14;break;case 13:return e.abrupt("return");case 14:return e.next=17,this.rootStore.Airgram.api.getChatHistory({chatId:this.chatId,limit:100,fromMessageId:this.startMessage});case 17:if("messages"!==(n=e.sent).response._){e.next=34;break}if(0!==(r=n.response).totalCount){e.next=23;break}return this.canLoad=!1,e.abrupt("break",37);case 23:s=r.messages[r.messages.length-1],this.startMessage=s.id,a=Array.from(r.messages.reduce((function(e,t){return"messageSticker"!==t.content._||e.has(t.content.sticker.setId)||h.stickerIds.has(t.content.sticker.setId)||e.set(t.content.sticker.setId,t),e}),new Map).values()).filter((function(e){return!h.messageIds.has(e.id)})),i=Object(Ye.a)(a);try{for(i.s();!(c=i.n()).done;)o=c.value,u=o.content,this.messageIds.set(o.id,!0),this.stickerIds.set(u.sticker.setId,!0),this.insertMessage(o)}catch(d){i.e(d)}finally{i.f()}if(this.setLoadingProgress(this.processed+r.totalCount,this.total+r.totalCount,this.batch+1),this.save(),!a.length){e.next=32;break}return e.abrupt("return",a.length);case 32:e.next=35;break;case 34:return e.abrupt("return");case 35:e.next=14;break;case 37:e.next=42;break;case 39:e.prev=39,e.t0=e.catch(4),console.log(e.t0);case 42:return e.prev=42,this.save(),this.setLoading(!1),e.finish(42);case 46:case"end":return e.stop()}}),e,this,[[4,39,42,46]])})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this.chat,t=this.messages,n=this.messageIds,r=this.stickerIds,s=this.startMessage,a=this.canLoad;Ge.set(this.chatId,{chat:e,messages:t,messageIds:n,stickerIds:r,startMessage:s,canLoad:a})}}]),e}(),$e=Object(c.a)((function(e){var t=e.store;return t.isLoading?Object(p.jsx)(o.g,{children:Object(p.jsxs)(o.k,{span:!0,type:"secondary",children:["Loading messages (",t.processed,"/",t.total," batch: ",t.batch,")"]})}):Object(p.jsx)(o.k,{span:!0,type:"secondary",children:"Scroll to start loading"})})),et=new Map,tt=function(){function e(t,n){Object(z.a)(this,e),this.rootStore=t,this.setId=n,this.set=void 0,Object(H.d)(this,{set:H.f.ref})}return Object(M.a)(e,[{key:"load",value:function(){var e=Object(R.a)(D.a.mark((function e(){var t,n,r=this;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.set){e.next=2;break}return e.abrupt("return");case 2:if(!et.has(this.setId)){e.next=6;break}return t=et.get(this.setId),Object(H.g)((function(){r.set=t})),e.abrupt("return");case 6:return e.next=8,this.rootStore.Airgram.api.getStickerSet({setId:this.setId});case 8:"stickerSet"===(n=e.sent).response._&&(Object(H.g)((function(){r.set=n.response})),et.set(this.setId,this.set));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),nt=n(42),rt=n.n(nt),st=["message"],at=Object(c.a)((function(e){var t,n=e.message,r=Object(d.a)(e,st),s=n.content.sticker,h=Object(i.useContext)(se),l=Object(c.b)((function(){return new tt(h,s.setId)}));return Object(i.useEffect)((function(){l.load()}),[l]),Object(p.jsx)(a.b,Object(u.a)(Object(u.a)({className:rt.a.root,to:"/set/".concat(s.setId)},r),{},{children:Object(p.jsxs)(o.d.Container,{gap:1,direction:"column",children:[Object(p.jsx)(o.d,{children:Object(p.jsx)(o.k,{b:!0,type:"secondary",children:null===(t=l.set)||void 0===t?void 0:t.title})}),Object(p.jsx)(o.d.Container,{className:rt.a.container,alignItems:"center",children:Object(p.jsx)(Oe,{sticker:s})})]})}))})),it=n(66),ct=n.n(it),ot=n(43),ut=n.n(ot),ht=1e3,dt=new Map,lt=ut()((function(e){return{minHeight:"100%",height:"".concat(e,"px"),width:"100%",position:"relative"}})),bt=ut()((function(e,t){return{position:"absolute",top:t,left:0,height:e,width:"100%",padding:32}})),jt=Object(c.a)((function(e){var t,n=e.match.params.id,r=parseInt(n),s=Object(ze.g)(),a=Object(i.useContext)(se),c=a.Chats,u=Object(i.useState)((function(){return new Xe(a,r)})),h=Object(x.a)(u,1)[0],d=h.chat,l=h.messages,b=je(null===d||void 0===d||null===(t=d.photo)||void 0===t?void 0:t.small,"base64"),j=Object(i.useRef)(),f=l.length;h.canLoad&&f++;var O=Object(i.useCallback)((function(e){return h.canLoad&&0===e?ht:420}),[h.canLoad]),m=Object(De.a)({size:f,parentRef:j,estimateSize:O}),g=m.virtualItems,k=m.totalSize,w=m.scrollToOffset,y=Object(i.useCallback)((function(e){if(j.current&&e){var t=420*e;j.current.scrollTop+=t,w(j.current.scrollTop)}}),[w]);Object(i.useEffect)((function(){var e;dt.has(r)?w(null!==(e=dt.get(r))&&void 0!==e?e:0):y(h.messages.length)}),[]),Object(i.useEffect)((function(){return c.chats.has(r)&&Object(R.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.init();case 2:t=e.sent,y(t);case 4:case"end":return e.stop()}}),e)})))(),function(){h.dispose()}}),[c.chats,r,y,h]);var C=Object(i.useCallback)(Object(R.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(j.current&&j.current.scrollTop<800)){e.next=5;break}return e.next=3,h.load();case 3:t=e.sent,y(t);case 5:case"end":return e.stop()}}),e)}))),[y,h]);Object(i.useEffect)((function(){h.canLoad||(j.current.scrollTop-=ht)}),[h.canLoad]),Object(i.useEffect)((function(){C()}),[C,l.length]);var I=Object(i.useCallback)((function(e){C();var t=e.target;dt.set(r,t.scrollTop)}),[r,C]);if(!n)return Object(p.jsx)(v,{children:Object(p.jsx)(o.k,{type:"secondary",children:"Please choose a conversation "})});var T=lt(k);return Object(p.jsxs)(o.d.Container,{direction:"column",justify:"flex-start",alignItems:"stretch",children:[Object(p.jsxs)(ve,{children:[!!s.length&&Object(p.jsx)(o.d,{md:0,children:Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:Object(p.jsx)(Me.a,{}),onClick:s.goBack})}),Object(p.jsx)(o.d,{xs:!0,children:Object(p.jsx)(ke,{src:b,name:null===d||void 0===d?void 0:d.title})})]}),Object(p.jsx)(o.d.Container,{className:ct.a.root,direction:"column",justify:"flex-start",children:Object(p.jsx)(S,{ref:j,onScroll:I,children:Object(p.jsx)("div",{style:T,children:g.map((function(e){var t=e.index,n=e.start,r=e.size,s=t;h.canLoad&&s--;var a=bt(r,n);if(s<0)return Object(p.jsx)(o.d.Container,{gap:0,alignItems:"flex-end",style:a,children:Object(p.jsx)(o.d,{xs:!0,justify:"center",padding:"50px",children:Object(p.jsx)($e,{store:h})})},t);var i=l[s];return Object(p.jsx)(at,{style:a,message:i},i.id)}))})})})]})})),ft=n(67),pt=n.n(ft),Ot=Object(c.a)((function(e){var t=e.match.params.id,n=Object(ze.g)(),r=Object(i.useContext)(se),s=Object(c.b)((function(){return new tt(r,t)})),a=s.set;return Object(i.useEffect)((function(){s.load()}),[]),Object(p.jsxs)(o.d.Container,{direction:"column",justify:"flex-start",alignItems:"stretch",children:[Object(p.jsxs)(ve,{children:[!!n.length&&Object(p.jsx)(o.d,{md:0,children:Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:Object(p.jsx)(Me.a,{}),onClick:n.goBack})}),Object(p.jsx)(o.d,{xs:!0,children:Object(p.jsx)(o.k,{h5:!0,margin:0,children:null===a||void 0===a?void 0:a.title})})]}),Object(p.jsx)(S,{className:pt.a.root,children:Object(p.jsx)(o.d.Container,{justify:"flex-start",children:null===a||void 0===a?void 0:a.stickers.map((function(e){return Object(p.jsx)(o.d,{xs:24,sm:12,md:12,lg:8,xl:6,justify:"center",children:Object(p.jsx)(Oe,{sticker:e})},e.sticker.id)}))})})]})})),vt=n(44),xt=n.n(vt);function mt(e){return Object(p.jsx)(jt,Object(u.a)({},e),e.match.params.id)}function gt(e){return Object(p.jsx)(Ot,Object(u.a)({},e),e.match.params.id)}function kt(){var e=Object(o.m)("sm",{match:"down"});return Object(p.jsx)(o.d.Container,{gap:0,width:"100%",height:"100%",children:e?Object(p.jsxs)(ze.d,{children:[Object(p.jsx)(ze.b,{path:"/chats",component:Ke}),Object(p.jsx)(ze.b,{path:"/conversation/:id",component:mt}),Object(p.jsx)(ze.b,{path:"/set/:id",component:gt}),Object(p.jsx)(ze.a,{to:"chats"})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.d,{className:xt.a.panel,sm:8,md:6,lg:4,xl:2,children:Object(p.jsx)(Ke,{})}),Object(p.jsx)(o.d,{className:xt.a.panel,sm:16,md:18,lg:20,xl:22,children:Object(p.jsxs)(ze.d,{children:[Object(p.jsx)(ze.b,{path:"/conversation/:id?",component:mt}),Object(p.jsx)(ze.b,{path:"/set/:id",component:gt}),Object(p.jsx)(ze.a,{to:"conversation"})]})})]})})}var wt=function(){var e=Object(i.useContext)(se).Theme,t="dark"===e.currentTheme;return Object(p.jsxs)(o.d.Container,{wrap:"nowrap",gap:0,height:"50px",alignItems:"center",children:[Object(p.jsx)(o.i,{w:.5}),Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:t?Object(p.jsx)(Me.d,{}):Object(p.jsx)(Me.e,{}),onClick:function(){return e.toggleTheme()}}),Object(p.jsx)("div",{style:{flex:1}}),Object(p.jsxs)(o.k,{span:!0,children:["Made with"," ",Object(p.jsx)(o.f,{underline:!0,href:"https://airgram.netlify.app/",target:"_blank",rel:"noopener noreferrer",children:"Airgram"}),","," ",Object(p.jsx)(o.f,{underline:!0,href:"https://react.geist-ui.dev/",target:"_blank",rel:"noopener noreferrer",children:"Geist UI"})," ","and ",Object(p.jsx)(Me.b,{color:"red"})]}),Object(p.jsx)(o.i,{})]})};var yt=Object(c.a)((function(){var e=Object(i.useContext)(se),t=e.Theme,n=e.Chats;return Object(i.useEffect)((function(){n.load()}),[]),Object(p.jsxs)(o.c,{themeType:t.currentTheme,children:[Object(p.jsx)(g,{}),Object(p.jsx)(o.b,{}),Object(p.jsxs)(o.h,{render:"effect-seo",scale:.5,width:"100%",padding:0,children:[Object(p.jsx)(o.h.Content,{paddingTop:0,children:Object(p.jsx)(Re,{children:Object(p.jsx)(kt,{})})}),Object(p.jsx)(o.h.Footer,{children:Object(p.jsx)(wt,{})})]})]})})),Ct=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1272)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),s(e),a(e),i(e)}))};s.a.render(Object(p.jsx)(ae,{children:Object(p.jsx)(a.a,{children:Object(p.jsx)(yt,{})})}),document.getElementById("root")),Ct()},34:function(e,t,n){e.exports={chat:"ChatRow_chat__IbOPK",active_chat:"ChatRow_active_chat__2ZRAR"}},39:function(e,t,n){e.exports={root:"CenterLayout_root__L4_bA",padding:"CenterLayout_padding__3SYoM"}},40:function(e,t,n){e.exports={root:"Sticker_root__gZJDN"}},42:function(e,t,n){e.exports={container:"Message_container__L0WXx"}},44:function(e,t,n){e.exports={panel:"Root_panel__2Hl4e"}},55:function(e,t,n){e.exports={thumb:"List_thumb__2th6t"}},60:function(e,t,n){e.exports={card:"UserCard_card__3-Fjo"}},62:function(e,t,n){e.exports={codeArea:"QrCode_codeArea__1c03P"}},65:function(e,t,n){e.exports={root:"Chats_root__31lV_"}},66:function(e,t,n){e.exports={root:"Conversation_root__1cN7I"}},67:function(e,t,n){e.exports={root:"Set_root__1thkL"}},72:function(e,t,n){}},[[1271,1,2]]]);
//# sourceMappingURL=main.abcc6f2f.chunk.js.map