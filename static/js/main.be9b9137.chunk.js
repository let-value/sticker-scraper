(this["webpackJsonpsticker-scraper"]=this["webpackJsonpsticker-scraper"]||[]).push([[0],{1146:function(e,t,n){"use strict";n.r(t);var r=n(21),a=n.n(r),s=n(38),i=(n(81),n(82),n(0)),c=n(14),o=n(7),u=n(15),h=n(25),d=n(3),l=n(31),b=n.n(l),j=n(47),f=n.n(j),p=n(5),O=["className","disablePadding"],v=function(e){var t=e.className,n=e.disablePadding,r=Object(d.a)(e,O);return Object(p.jsx)("div",Object(u.a)({className:b()(f.a.root,Object(h.a)({},f.a.padding,!n),t)},r))},m=n(4),x=document.documentElement,g=function(){var e=Object(o.n)();return Object(i.useEffect)((function(){for(var t=e.palette,n=0,r=Object.entries(t);n<r.length;n++){var a=Object(m.a)(r[n],2),s=a[0],i=a[1];x.style.setProperty("--palette-"+s,i)}}),[e]),null},k=n(67),w=n.n(k),y=["style","children"],A=Object(i.forwardRef)((function(e,t){var n=e.style,r=e.children,a=Object(d.a)(e,y),s=Object(i.useCallback)((function(e){e&&t&&"object"===typeof t?t.current=e.view:e&&"function"===typeof t?null===t||void 0===t||t(e.view):"function"===typeof t&&(null===t||void 0===t||t(null))}),[]);return Object(p.jsx)(w.a,Object(u.a)(Object(u.a)({ref:s,style:Object(u.a)({},n)},a),{},{children:r}))})),C=n(8),T=n.n(C),I=n(10),_=n(16),S=n(17),N=n(37),L=n(68),E=n(11),P={apiId:parseInt("6544363"),apiHash:"86ef20b7ba5e5464dc7079e760e1499c",jsLogVerbosityLevel:"error",logVerbosityLevel:0,useSecretChats:!1},R=void 0;function z(){return M.apply(this,arguments)}function M(){return(M=Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R){e.next=3;break}return e.next=3,R.api.destroy();case 3:return t=new N.Airgram(P),R=t,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=n(13),F=n(32),H=function(){function e(){Object(_.a)(this,e),this.handlers=[]}return Object(S.a)(e,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.handlers.push(t),this}},{key:"build",value:function(){var e=this;return function(t,n){var r,a=null!==(r=e.handlers.filter((function(e){return Object(m.a)(e,1)[0]===t._})))&&void 0!==r?r:[];return a.length?F.Composer.compose(a.map((function(e){return Object(m.a)(e,2)[1]})))(t,n):n()}}}]),e}(),W=function(){function e(t){var n=this;Object(_.a)(this,e),this.rootStore=t,this.state=void 0,this.firstLaunch=!0,this.user=void 0,this.handlers=(new H).add(U.UPDATE.updateAuthorizationState,(function(e){var t,r=e.update.authorizationState;if(n.firstLaunch&&r._===U.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber&&(null===(t=n.state)||void 0===t?void 0:t._)===U.AUTHORIZATION_STATE.authorizationStateWaitEncryptionKey)return n.firstLaunch=!1,void n.switchToQr();n.state=r})).build(),Object(E.d)(this,{handlers:!1})}return Object(S.a)(e,[{key:"switchToQr",value:function(){var e=Object(I.a)(T.a.mark((function e(){var t,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.state)||void 0===t?void 0:t._)!==U.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.rootStore.Airgram.api.requestQrCodeAuthentication();case 4:if("error"!==(n=e.sent).response._){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"switchToPhoneNumber",value:function(){var e=Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.state)||void 0===t?void 0:t._)!==U.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.reset();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){var e=Object(I.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.firstLaunch=!1,e.next=3,this.rootStore.resetAirgram();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logOut",value:function(){var e=Object(I.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rootStore.Airgram.api.logOut();case 2:return this.firstLaunch=!0,e.next=5,this.rootStore.resetAirgram();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendPhoneNumber",value:function(e){return this.rootStore.Airgram.api.setAuthenticationPhoneNumber({phoneNumber:e})}},{key:"sendCode",value:function(e){return this.rootStore.Airgram.api.checkAuthenticationCode({code:e})}},{key:"sendPassword",value:function(e){return this.rootStore.Airgram.api.checkAuthenticationPassword({password:e})}},{key:"getMe",value:function(){var e=Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rootStore.Airgram.api.getMe();case 2:if("error"!==(t=e.sent).response._){e.next=5;break}throw t.response;case 5:this.user=t.response;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Z=function(){function e(t){var n=this;Object(_.a)(this,e),this.rootStore=t,this.chats=new Map,this.handlers=(new H).add(U.UPDATE.updateNewChat,(function(e,t){return n.updateChat(e.update.chat.id,(function(t){t.info=e.update.chat})),t()})).add(U.UPDATE.updateChatPosition,(function(e,t){return n.updateChat(e.update.chatId,(function(t){t.position=e.update.position})),t()})).add(U.UPDATE.updateChatLastMessage,(function(e,t){n.updateChat(e.update.chatId,(function(t){t.lastMessage=e.update.lastMessage}));var r=e.update.positions.find((function(e){return"chatListMain"===e.list._}));return r&&n.updateChat(e.update.chatId,(function(e){e.position=r})),t()})).build(),Object(E.d)(this,{handlers:!1})}return Object(S.a)(e,[{key:"updateChat",value:function(e,t){var n,r=this.chats.get(e);r||(r={}),r=null!==(n=t(r))&&void 0!==n?n:r,this.chats.set(e,r)}},{key:"load",value:function(){var e="9223372036854775807";if(this.chatsList.length){var t,n=null===(t=this.chatsList[this.chatsList.length-1].position)||void 0===t?void 0:t.order;n&&(e=n)}this.rootStore.Airgram.api.getChats({chatList:{_:"chatListMain"},limit:10,offsetOrder:e})}},{key:"chatsList",get:function(){return Array.from(this.chats.values()).sort((function(e,t){var n,r,a,s;return BigInt(null!==(n=null===(r=e.position)||void 0===r?void 0:r.order)&&void 0!==n?n:0)<BigInt(null!==(a=null===(s=t.position)||void 0===s?void 0:s.order)&&void 0!==a?a:0)?0:-1})).sort((function(e,t){var n,r,a=null===(n=e.position)||void 0===n?void 0:n.isPinned;return a===(null===(r=t.position)||void 0===r?void 0:r.isPinned)?0:a?-1:1}))}}]),e}(),D=function e(t){var n=this;Object(_.a)(this,e),this.rootStore=t,this.state=U.CONNECTION_STATE.connectionStateWaitingForNetwork,this.middleware=function(){return function(){var e=Object(I.a)(T.a.mark((function e(t,r){var a,s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._===U.UPDATE.updateConnectionState&&"update"in t&&(a=t.update,s=a.state._,n.state=s),e.abrupt("return",r());case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},Object(E.d)(this,{middleware:!1})},B="theme",q="light";window.matchMedia("(prefers-color-scheme: dark)").matches&&(q="dark");var Q=localStorage.getItem(B);Q&&(q=Q);var V=function(){function e(){Object(_.a)(this,e),this.currentTheme=q,Object(E.d)(this)}return Object(S.a)(e,[{key:"toggleTheme",value:function(){var e="dark"===this.currentTheme?"light":"dark";this.currentTheme=e,localStorage.setItem(B,e)}}]),e}(),J=function(){function e(){var t=this;Object(_.a)(this,e),this.events=new L.EventEmitter,this.emit=function(n,r){var a,s=null!==(a=t.events.listeners(e.eventName))&&void 0!==a?a:[];return N.Composer.compose(s)(n,r)},this.Theme=new V,this.Airgram=void 0,this.Authorization=new W(this),this.Connection=new D(this),this.Chats=new Z(this),this.resetAirgram(),Object(E.d)(this,{events:!1,Airgram:!1})}return Object(S.a)(e,[{key:"resetAirgram",value:function(){var e=Object(I.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:this.Airgram=e.sent,this.Airgram.use(this.Authorization.handlers,this.Connection,this.Chats.handlers,this.emit);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();J.eventName="action";var K=new J,Y=Object(i.createContext)(K),G=function(e){var t=e.children;return Object(p.jsx)(Y.Provider,{value:K,children:t})},X=function(e){return Object(p.jsx)(o.d.Container,Object(u.a)({wrap:"nowrap",height:"64px",alignItems:"center"},e))},$=n(69),ee=n.n($),te=["className"],ne=function(e){var t=e.className,n=Object(d.a)(e,te);return Object(p.jsx)(o.l,Object(u.a)({className:b()(ee.a.card,t)},n))},re=n(29),ae=function(){var e=Object(i.useContext)(Y).Authorization,t=Object(i.useState)(!1),n=Object(m.a)(t,2),r=n[0],a=n[1],s=Object(re.b)(),c=s.formState.errors,h=s.register,d=s.handleSubmit,l=s.setError,b=Object(i.useCallback)(function(){var t=Object(I.a)(T.a.mark((function t(n){var s,i;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.phoneNumber,!r){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,a(!0),t.next=7,e.sendPhoneNumber(s);case 7:if("error"!==(i=t.sent).response._){t.next=10;break}throw i.response._;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),l("phoneNumber",t.t0);case 15:return t.prev=15,a(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})));return function(e){return t.apply(this,arguments)}}(),[e,r,l]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:d(b),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Log in to Telegram"}),Object(p.jsx)(o.k,{margin:0,children:"by phone number"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.e,Object(u.a)({autoFocus:!0,disabled:r,type:c.phoneNumber?"error":void 0},h("phoneNumber",{required:!0}))),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{disabled:r,htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{ghost:!0,type:"success",onClick:function(){return e.switchToQr()},children:"Log in by qr code"})]})})})},se=Object(c.a)((function(){var e=Object(i.useContext)(Y).Authorization,t=Object(re.b)(),n=t.handleSubmit,r=t.setError,a=t.control,s=e.state,c=Object(re.a)({defaultValue:"",name:"code",rules:{required:!0},control:a}),u=c.field,h=u.value,d=u.onChange,l=c.fieldState.error,b=Object(i.useCallback)(function(){var t=Object(I.a)(T.a.mark((function t(n){var a,s;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.code,t.prev=1,t.next=4,e.sendCode(a);case 4:if("error"!==(s=t.sent).response._){t.next=7;break}throw s.response._;case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),r("code",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),[e,r]),j=Object(i.useCallback)((function(e){var t=e.target.value;d(t),5===t.length&&n(b)(e)}),[n,d,b]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:n(b),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:s.codeInfo.phoneNumber}),Object(p.jsx)(o.e,{autoFocus:!0,label:"Code",type:l?"error":void 0,value:h,onChange:j}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{type:"success",ghost:!0,onClick:function(){return e.reset()},children:"Reset"})]})})})})),ie=Object(c.a)((function(){var e=Object(i.useContext)(Y).Authorization,t=Object(i.useState)(!1),n=Object(m.a)(t,2),r=n[0],a=n[1],s=Object(re.b)(),c=s.formState.errors,h=s.register,d=s.handleSubmit,l=s.setError,b=e.state,j=Object(i.useCallback)(function(){var t=Object(I.a)(T.a.mark((function t(n){var s,i;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.password,!r){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,a(!0),t.next=7,e.sendPassword(s);case 7:if("error"!==(i=t.sent).response._){t.next=10;break}throw i.response._;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),l("password",t.t0);case 15:return t.prev=15,a(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})));return function(e){return t.apply(this,arguments)}}(),[e,r,l]);return Object(p.jsx)(v,{children:Object(p.jsx)("form",{onSubmit:d(j),children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Enter Your Password"}),Object(p.jsx)(o.e.Password,Object(u.a)({autoFocus:!0,disabled:r,placeholder:b.passwordHint,type:c.password?"error":void 0},h("password",{required:!0}))),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{disabled:r,htmlType:"submit",type:"success",children:"Next"}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{type:"success",ghost:!0,onClick:function(){return e.reset()},children:"Reset"})]})})})})),ce=n(70),oe=n.n(ce),ue=n(71),he=n.n(ue),de=Object(c.a)((function(){var e=Object(i.useContext)(Y).Authorization,t=e.state;return Object(p.jsx)(v,{children:Object(p.jsxs)(o.d.Container,{direction:"column",alignContent:"center",alignItems:"center",children:[Object(p.jsx)(o.k,{h3:!0,children:"Log in to Telegram"}),Object(p.jsx)(o.k,{margin:0,children:"by qr code"}),Object(p.jsx)(o.i,{}),Object(p.jsx)("div",{className:he.a.codeArea,children:Object(p.jsx)(v,{disablePadding:!0,children:t.link?Object(p.jsx)(oe.a,{includeMargin:!0,renderAs:"svg",value:t.link,size:240}):Object(p.jsx)(o.j,{})})}),Object(p.jsx)(o.i,{}),Object(p.jsx)(o.a,{ghost:!0,type:"success",onClick:function(){return e.switchToPhoneNumber()},children:"Log in by phone number"})]})})})),le=Object(c.a)((function(){var e,t,n,r,a=Object(i.useContext)(Y).Authorization;return(null===(e=a.state)||void 0===e?void 0:e._)===U.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber?Object(p.jsx)(ae,{}):(null===(t=a.state)||void 0===t?void 0:t._)===U.AUTHORIZATION_STATE.authorizationStateWaitCode?Object(p.jsx)(se,{}):(null===(n=a.state)||void 0===n?void 0:n._)===U.AUTHORIZATION_STATE.authorizationStateWaitPassword?Object(p.jsx)(ie,{}):(null===(r=a.state)||void 0===r?void 0:r._)===U.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation?Object(p.jsx)(de,{}):null})),be=[U.AUTHORIZATION_STATE.authorizationStateWaitTdlibParameters,U.AUTHORIZATION_STATE.authorizationStateWaitEncryptionKey],je=[U.AUTHORIZATION_STATE.authorizationStateWaitPhoneNumber,U.AUTHORIZATION_STATE.authorizationStateWaitCode,U.AUTHORIZATION_STATE.authorizationStateWaitPassword,U.AUTHORIZATION_STATE.authorizationStateWaitOtherDeviceConfirmation],fe=Object(c.a)((function(e){var t=e.children,n=Object(i.useContext)(Y).Authorization;return!n.state||be.includes(n.state._)?Object(p.jsx)(v,{children:Object(p.jsx)(o.j,{scale:5})}):je.includes(n.state._)?Object(p.jsx)(le,{}):Object(p.jsx)(p.Fragment,{children:t})})),pe=n(12),Oe=n(72),ve=n.n(Oe);function me(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(I.a)(T.a.mark((function e(t){var n,r,a,s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.arrayBuffer();case 2:return n=e.sent,r=new Uint8Array(n),a=ve.a.inflate(r),e.next=7,new Blob([a]).text();case 7:return s=e.sent,e.abrupt("return",JSON.parse(s));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){return new Response(new Blob([e],{type:"application/json"})).text()}function ke(e){return new Response(e).text()}function we(e){var t=new FileReader;return t.readAsDataURL(e),new Promise((function(e,n){t.onloadend=function(){e(t.result)},t.onerror=function(e){n(e)}}))}var ye=new Map,Ae=function(){function e(t,n,r,a){var s=this;Object(_.a)(this,e),this.rootStore=t,this.isLoading=!1,this.format=void 0,this.file=void 0,this.content=void 0,this.params=void 0,this.handlers=(new H).add(U.UPDATE.updateFile,(function(e,t){var n;return e.update.file.id===(null===(n=s.file)||void 0===n?void 0:n.id)&&s.load(),t()})).build(),Object(E.d)(this,{content:E.f.ref}),this.file=n,this.format=r,this.params=a,this.load(),t.events.addListener(J.eventName,this.handlers)}return Object(S.a)(e,[{key:"dispose",value:function(){this.rootStore.events.removeListener(J.eventName,this.handlers)}},{key:"setFile",value:function(e,t,n){return this.file=e,this.format!==t&&(this.content=void 0,this.format=t),this.params=n,this.load()}},{key:"load",value:function(){var e=Object(I.a)(T.a.mark((function e(){var t,n,r,a,s,i;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.file&&!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(!this.content){e.next=4;break}return e.abrupt("return",this.content);case 4:if(e.prev=4,this.isLoading=!0,t=this.file.id,!(n=ye.get(t))){e.next=11;break}return this.content=n,e.abrupt("return",n);case 11:return console.log("load",t),e.next=14,this.rootStore.Airgram.api.downloadFile(Object(u.a)({fileId:t,priority:1},this.params));case 14:if("error"!==(r=e.sent).response._){e.next=18;break}return console.log("downloadFile",t,r.response),e.abrupt("return");case 18:return e.next=20,this.rootStore.Airgram.api.readFilePart({fileId:t});case 20:if("error"!==(a=e.sent).response._){e.next=24;break}return console.log("readFilePart",t,a.response),e.abrupt("return");case 24:if(s=a.response.data,i=null,"blob"===this.format&&(i=s),"base64"!==this.format){e.next=31;break}return e.next=30,we(s);case 30:i=e.sent;case 31:if("text"!==this.format){e.next=35;break}return e.next=34,ke(s);case 34:i=e.sent;case 35:if("json"!==this.format){e.next=39;break}return e.next=38,ge(s);case 38:i=e.sent;case 39:if("lotty"!==this.format){e.next=43;break}return e.next=42,me(s);case 42:i=e.sent;case 43:return ye.set(t,i),this.content=i,e.abrupt("return",i);case 46:return e.prev=46,this.isLoading=!1,e.finish(46);case 49:case"end":return e.stop()}}),e,this,[[4,,46,49]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function Ce(e,t,n){var r=Object(c.b)((function(){return new Ae(K)}));return Object(i.useEffect)((function(){return function(){r.dispose()}}),[]),Object(i.useEffect)((function(){r.setFile(e,t,n)}),[e,t,n,r]),r.content}var Te=n(28),Ie=Object(c.a)((function(){var e,t,n=Object(i.useContext)(Y).Authorization,r=Ce(null===(e=n.user)||void 0===e||null===(t=e.profilePhoto)||void 0===t?void 0:t.small,"base64",{priority:32});return Object(i.useEffect)((function(){n.getMe()}),[]),n.user?Object(p.jsxs)(o.d.Container,{wrap:"nowrap",alignItems:"center",xs:!0,children:[Object(p.jsx)(ne,{src:r,name:"".concat(n.user.firstName," ").concat(n.user.lastName),children:n.user.username}),Object(p.jsx)("div",{style:{flex:1}}),Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:Object(p.jsx)(Te.c,{}),onClick:function(){return n.logOut()}})]}):Object(p.jsx)(o.j,{})})),_e=n(39),Se=n(41),Ne=n.n(Se),Le=["chat","className"],Ee=function(e){var t,n,r,a,i=e.chat,c=e.className,h=Object(d.a)(e,Le),l=Ce(null===(t=i.info)||void 0===t||null===(n=t.photo)||void 0===n?void 0:n.small,"base64");return Object(p.jsx)(s.b,Object(u.a)(Object(u.a)({to:"/conversation/".concat(null===(r=i.info)||void 0===r?void 0:r.id),className:b()(Ne.a.chat,c),activeClassName:Ne.a.active_chat},h),{},{children:Object(p.jsx)(o.d.Container,{className:Ne.a.container,alignItems:"center",height:"100%",width:"100%",children:Object(p.jsx)(ne,{src:l,name:null===(a=i.info)||void 0===a?void 0:a.title})})}))},Pe=Object(i.memo)(Ee),Re=n(74),ze=n.n(Re),Me=0,Ue=Object(c.a)((function(){var e=Object(i.useContext)(Y).Chats,t=e.chatsList;Object(i.useEffect)((function(){e.load()}),[]);var n=Object(i.useRef)(),r=Object(_e.a)({size:t.length,parentRef:n,estimateSize:Object(i.useCallback)((function(){return 64}),[])});Object(i.useEffect)((function(){r.scrollToOffset(Me)}),[]);var a=Object(i.useCallback)((function(e){var t=e.target;Me=t.scrollTop}),[]);return Object(p.jsx)(o.d.Container,{className:ze.a.root,direction:"column",justify:"flex-start",children:Object(p.jsx)(A,{ref:n,onScroll:a,children:Object(p.jsx)("div",{style:{height:"".concat(r.totalSize,"px"),width:"100%",position:"relative"},children:r.virtualItems.map((function(e){var n,r,a=e.index,s=e.size,i=e.start,c=t[a];return Object(p.jsx)(Pe,{chat:c,style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(s,"px"),transform:"translateY(".concat(i,"px)")}},null!==(n=null===(r=c.info)||void 0===r?void 0:r.id)&&void 0!==n?n:a)}))})})})})),Fe=Object(c.a)((function(){return Object(p.jsxs)(o.d.Container,{direction:"column",justify:"flex-start",alignItems:"stretch",children:[Object(p.jsx)(X,{children:Object(p.jsx)(Ie,{})}),Object(p.jsx)(Ue,{})]})})),He=n(18),We=new Map,Ze=function(){function e(t,n){var r=this;if(Object(_.a)(this,e),this.rootStore=t,this.chatId=n,this.isLoading=!1,this.isRestored=!1,this.startMessage=0,this.canLoad=!0,this.chat=void 0,this.messages=[],this.messageIds=new Map,this.stickerIds=new Map,this.handlers=(new H).add(U.UPDATE.updateNewMessage,(function(e,t){var n=e.update.message;if(n.chatId===r.chatId&&!r.messageIds.has(n.id)){var a;if(r.messageIds.set(n.id,!0),"messageSticker"===n.content._&&!r.stickerIds.has(n.content.sticker.setId))null===(a=r.messages)||void 0===a||a.push(n),r.stickerIds.set(n.content.sticker.setId,!0);r.save()}return t()})).build(),We.has(n)){var a=We.get(n);Object.assign(this,a),this.isRestored=!0}Object(E.d)(this,{dispose:!1,handlers:!1}),t.events.addListener(J.eventName,this.handlers)}return Object(S.a)(e,[{key:"dispose",value:function(){this.rootStore.events.removeListener(J.eventName,this.handlers)}},{key:"init",value:function(){if(!this.isRestored)return this.load()}},{key:"load",value:function(){var e=Object(I.a)(T.a.mark((function e(){var t,n,r,a,s,i,c,o,u,h=this;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canLoad&&!this.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(this.isLoading=!0,e.prev=3,this.chat){e.next=9;break}return e.next=7,this.rootStore.Airgram.api.getChat({chatId:this.chatId});case 7:"chat"===(t=e.sent).response._&&(this.chat=t.response);case 9:return e.next=12,this.rootStore.Airgram.api.getChatHistory({chatId:this.chatId,limit:100,fromMessageId:this.startMessage});case 12:if("messages"!==(n=e.sent).response._){e.next=25;break}if(0!==(r=n.response).totalCount){e.next=18;break}return this.canLoad=!1,e.abrupt("break",27);case 18:a=r.messages[r.messages.length-1],this.startMessage=a.id,s=Array.from(r.messages.reduce((function(e,t){return"messageSticker"!==t.content._||e.has(t.content.sticker.setId)||h.stickerIds.has(t.content.sticker.setId)||e.set(t.content.sticker.setId,t),e}),new Map).values()).filter((function(e){return!h.messageIds.has(e.id)})),i=Object(He.a)(s);try{for(i.s();!(c=i.n()).done;)o=c.value,u=o.content,this.messageIds.set(o.id,!0),this.stickerIds.set(u.sticker.setId,!0),this.messages.unshift(o)}catch(d){i.e(d)}finally{i.f()}if(!s.length){e.next=25;break}return e.abrupt("return",s.length);case 25:e.next=9;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(3),console.log(e.t0);case 32:return e.prev=32,this.save(),this.isLoading=!1,e.finish(32);case 36:case"end":return e.stop()}}),e,this,[[3,29,32,36]])})));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this.chat,t=this.messages,n=this.messageIds,r=this.stickerIds,a=this.startMessage,s=this.canLoad;We.set(this.chatId,{chat:e,messages:t,messageIds:n,stickerIds:r,startMessage:a,canLoad:s})}}]),e}(),De=n(75),Be=n.n(De),qe=n(42),Qe=n.n(qe),Ve=["message"],Je=Object(c.a)((function(e){var t=e.message,n=t.content.sticker,r=Ce(n.sticker,n.isAnimated?"lotty":"base64");return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.d,{children:t.sender._}),Object(p.jsx)(o.d,{className:Qe.a.sticker,children:n.isAnimated?Object(p.jsx)(Be.a,{renderer:"svg",className:Qe.a.sticker,animationData:r}):Object(p.jsx)("img",{className:Qe.a.sticker,alt:"",src:r})})]})})),Ke=function(e){var t=e.message,n=Object(d.a)(e,Ve);return Object(p.jsx)(o.d.Container,Object(u.a)(Object(u.a)({gap:0,direction:"column"},n),{},{children:Object(p.jsx)(Je,{message:t})}))},Ye=n(76),Ge=n.n(Ye),Xe=n(50),$e=n.n(Xe),et=1e3,tt=$e()((function(e){return{minHeight:"100%",height:"".concat(e,"px"),width:"100%",position:"relative"}})),nt=$e()((function(e,t){return{position:"absolute",top:t,left:0,height:e,width:"100%"}})),rt=Object(c.a)((function(e){var t,n=e.match.params.id,r=parseInt(n),a=Object(i.useContext)(Y),s=a.Chats,c=Object(i.useState)((function(){return new Ze(a,r)})),u=Object(m.a)(c,1)[0],h=u.chat,d=u.messages,l=Ce(null===h||void 0===h||null===(t=h.photo)||void 0===t?void 0:t.small,"base64");Object(i.useEffect)((function(){return s.chats.has(r)&&u.init(),function(){u.dispose()}}),[s.chats,r,u]);var b=Object(i.useRef)(),j=d.length;u.canLoad&&j++;var f=Object(i.useCallback)((function(e){return u.canLoad&&0===e?et:348}),[u.canLoad]),O=Object(_e.a)({size:j,parentRef:b,estimateSize:f}),x=Object(i.useCallback)(Object(I.a)(T.a.mark((function e(){var t;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(b.current&&b.current.scrollTop<950)){e.next=5;break}return e.next=3,u.load();case 3:(t=e.sent)&&(b.current.scrollTop+=348*t);case 5:case"end":return e.stop()}}),e)}))),[u]);Object(i.useEffect)((function(){u.canLoad||(b.current.scrollTop-=et)}),[u.canLoad]),Object(i.useEffect)((function(){x()}),[x,d.length]);var g=Object(i.useCallback)((function(){x()}),[x]);if(!n)return Object(p.jsx)(v,{children:Object(p.jsx)(o.k,{type:"secondary",children:"Please choose a conversation "})});var k=tt(O.totalSize);return Object(p.jsxs)(o.d.Container,{direction:"column",justify:"flex-start",alignItems:"stretch",children:[Object(p.jsxs)(X,{children:[Object(p.jsx)(o.d,{sm:!0,md:0,children:Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:Object(p.jsx)(Te.a,{})})}),Object(p.jsx)(o.d,{xs:!0,children:Object(p.jsx)(ne,{src:l,name:null===h||void 0===h?void 0:h.title})})]}),Object(p.jsx)(o.d.Container,{className:Ge.a.root,direction:"column",justify:"flex-start",children:Object(p.jsx)(A,{ref:b,onScroll:g,children:Object(p.jsx)("div",{style:k,children:O.virtualItems.map((function(e){var t=e.index,n=e.start,r=e.size,a=t;u.canLoad&&a--;var s=nt(r,n);if(a<0)return Object(p.jsx)(o.d.Container,{alignItems:"flex-end",style:s,children:Object(p.jsx)(o.g,{children:"Loading messages"})},t);var i=d[a];return Object(p.jsx)(Ke,{style:s,message:i},i.id)}))})})})]})})),at=n(51),st=n.n(at);function it(){var e=Object(o.m)("sm",{match:"down"});return Object(p.jsx)(o.d.Container,{gap:0,width:"100%",height:"100%",children:e?Object(p.jsxs)(pe.d,{children:[Object(p.jsx)(pe.b,{path:"/chats",component:Fe}),Object(p.jsx)(pe.b,{path:"/conversation/:id",component:rt}),Object(p.jsx)(pe.a,{to:"chats"})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.d,{className:st.a.panel,sm:8,md:6,lg:4,xl:2,children:Object(p.jsx)(Fe,{})}),Object(p.jsx)(o.d,{className:st.a.panel,sm:16,md:18,lg:20,xl:22,children:Object(p.jsxs)(pe.d,{children:[Object(p.jsx)(pe.b,{path:"/conversation/:id?",render:function(e){return Object(p.jsx)(rt,Object(u.a)({},e),e.match.params.id)}}),Object(p.jsx)(pe.a,{to:"conversation"})]})})]})})}var ct=function(){var e=Object(i.useContext)(Y).Theme,t="dark"===e.currentTheme;return Object(p.jsxs)(o.d.Container,{wrap:"nowrap",gap:0,height:"50px",alignItems:"center",children:[Object(p.jsx)(o.i,{w:.5}),Object(p.jsx)(o.a,{auto:!0,type:"abort",iconRight:t?Object(p.jsx)(Te.d,{}):Object(p.jsx)(Te.e,{}),onClick:function(){return e.toggleTheme()}}),Object(p.jsx)("div",{style:{flex:1}}),Object(p.jsxs)(o.k,{span:!0,children:["Made with"," ",Object(p.jsx)(o.f,{underline:!0,href:"https://airgram.netlify.app/",target:"_blank",rel:"noopener noreferrer",children:"Airgram"}),","," ",Object(p.jsx)(o.f,{underline:!0,href:"https://react.geist-ui.dev/",target:"_blank",rel:"noopener noreferrer",children:"Geist UI"})," ","and ",Object(p.jsx)(Te.b,{color:"red"})]}),Object(p.jsx)(o.i,{})]})};var ot=Object(c.a)((function(){var e=Object(i.useContext)(Y).Theme;return Object(p.jsxs)(o.c,{themeType:e.currentTheme,children:[Object(p.jsx)(g,{}),Object(p.jsx)(o.b,{}),Object(p.jsxs)(o.h,{render:"effect-seo",scale:.5,width:"100%",padding:0,children:[Object(p.jsx)(o.h.Content,{paddingTop:0,children:Object(p.jsx)(fe,{children:Object(p.jsx)(it,{})})}),Object(p.jsx)(o.h.Footer,{children:Object(p.jsx)(ct,{})})]})]})})),ut=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1147)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),s(e),i(e)}))};a.a.render(Object(p.jsx)(G,{children:Object(p.jsx)(s.a,{children:Object(p.jsx)(ot,{})})}),document.getElementById("root")),ut()},41:function(e,t,n){e.exports={chat:"ChatRow_chat__IbOPK",active_chat:"ChatRow_active_chat__2ZRAR"}},42:function(e,t,n){e.exports={sticker:"Message_sticker__2bd3W"}},47:function(e,t,n){e.exports={root:"CenterLayout_root__L4_bA",padding:"CenterLayout_padding__3SYoM"}},51:function(e,t,n){e.exports={panel:"Root_panel__2Hl4e"}},69:function(e,t,n){e.exports={card:"UserCard_card__3-Fjo"}},71:function(e,t,n){e.exports={codeArea:"QrCode_codeArea__1c03P"}},74:function(e,t,n){e.exports={root:"Chats_root__31lV_"}},76:function(e,t,n){e.exports={root:"Conversation_root__1cN7I"}},81:function(e,t,n){}},[[1146,1,2]]]);
//# sourceMappingURL=main.be9b9137.chunk.js.map